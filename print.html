<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>cu-summer-stem-embedded-systems</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="The Cooper Union - Summer STEM Embedded Systems: C-ing Beyond Arduino">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-0f4f7d13.css">
        <link rel="stylesheet" href="css/general-d4e31f58.css">
        <link rel="stylesheet" href="css/chrome-49e8d624.css">
        <link rel="stylesheet" href="css/print-ad67d350.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome-799aeb25.css">
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight-56612340.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-2d018c37.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">cu-summer-stem-embedded-systems</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/jacobkoziej/cu-summer-stem-embedded-systems" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="cu-summer-stem-embedded-systems"><a class="header" href="#cu-summer-stem-embedded-systems">cu-summer-stem-embedded-systems</a></h1>
<blockquote>
<p>The Cooper Union - Summer STEM Embedded Systems: C-ing Beyond Arduino</p>
</blockquote>
<p>Starting with programming an Arduino Uno Rev3 with the Arduino framework and progressing to bare-metal C on the underlying AVR microcontroller, students will dive headfirst into the embedded world where all the safety is off, and all our favorite abstractions are gone.
Students will start with an Arduino and get comfortable interfacing with hardware using digital IO, PWM, ADCs, interrupts, and communications protocols like UART &amp; I2C.
Once familiar, the facade will get peeled away, and students will get a rundown of a Unix shell, computer architecture, compilers, build systems, and debuggers.
Using this new-found knowledge, students will go through the paces of writing a device driver using one of the available memory-mapped peripherals on an AVR microcontroller to gain familiarity with bare-metal C.
Throughout the course, students will get constant exposure to practical embedded applications and by the end, will have to come up with and implement an embedded application from scratch.</p>
<p><strong>Student outcomes:</strong></p>
<ul>
<li>Gain familiarity with embedded tools and hardware devices.</li>
<li>The ability to apply embedded programming techniques.</li>
<li>Successfully traverse datasheets and sample code.</li>
<li>Debugging techniques (software and hardware) along with collaboration.</li>
</ul>
<h2 id="copyright--licensing"><a class="header" href="#copyright--licensing">Copyright &amp; Licensing</a></h2>
<p>Copyright (C) 2025 Jacob Koziej <a href="mailto:jacobkoziej@gmail.com"><code>&lt;jacobkoziej@gmail.com&gt;</code></a></p>
<p>Distributed under the <a href="LICENSE"><code>CC-BY-NC-SA-4.0</code></a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="syllabus"><a class="header" href="#syllabus">Syllabus</a></h1>
<p>The following is a tentative syllabus for the Summer of 2025.
Please check this site frequently for the most up-to-date information.</p>
<h2 id="course-overview"><a class="header" href="#course-overview">Course Overview</a></h2>
<p><strong>Instructor:</strong> Jacob Koziej (EE ’25)</p>
<p><strong>Teaching Assistants:</strong> Marco Chen (EE ’28), Matthew Jeong (EE ’28), Charles Wan (STEM ’25)</p>
<p><strong>Location</strong>: 41 Cooper Square, Room 603 (ICE Lab)</p>
<p><strong>Time:</strong> Monday–Thursday, 09:00–15:00</p>
<p><strong>Office Hours:</strong> On request</p>
<p><strong>Contact:</strong> TEAMs message or email (<a href="mailto:jacob.koziej@cooper.edu"><code>&lt;jacob.koziej@cooper.edu&gt;</code></a>)</p>
<h2 id="prerequisite-skills"><a class="header" href="#prerequisite-skills">Prerequisite Skills</a></h2>
<p>Proficiency in any programming language; this could be something as simple as a block-based language<sup class="footnote-reference" id="fr-snap-1"><a href="#footnote-snap">1</a></sup>.</p>
<h2 id="course-goals"><a class="header" href="#course-goals">Course Goals</a></h2>
<p>The ultimate goal of this course is to familiarize you enough with embedded development that you can continue exploring beyond Arduino or move away from embedded as a more informed engineer.
By the end of the summer, you should be able to:</p>
<ul>
<li>Identify &amp; establish engineering problem requirements.</li>
<li>Decompose problems into digestible sub-problems.</li>
<li>Find and parse datasheets and reference manuals for relevant information.</li>
<li>Make sense of unfamiliar code.</li>
<li>Organize a programming project.</li>
<li>Write clean, effective, and defensive C code.</li>
<li>Debug with software and hardware.</li>
<li>Work with others on an engineering problem.</li>
<li>Understand the social implications of your work.</li>
<li>Be comfortable with being uncomfortable.</li>
</ul>
<p>This course aims to address the following <a href="https://abet.org">ABET</a> student outcomes:</p>
<ol>
<li>An ability to identify, formulate, and solve complex engineering problems by applying principles of engineering, science, and mathematics.</li>
<li>An ability to apply engineering design to produce solutions that meet specified needs with consideration of public health, safety, and welfare, as well as global, cultural, social, environmental, and economic factors.</li>
<li>An ability to communicate effectively with a range of audiences.</li>
<li>An ability to recognize ethical and professional responsibilities in engineering situations and make informed judgments, which must consider the impact of engineering solutions in global, economic, environmental, and societal contexts.</li>
<li>An ability to function effectively on a team whose members together provide leadership, create a collaborative environment, establish goals, plan tasks, and meet objectives.</li>
<li>An ability to develop and conduct appropriate experimentation, analyze and interpret data, and use engineering judgment to draw conclusions.</li>
<li>An ability to acquire and apply new knowledge as needed, using appropriate learning strategies.</li>
</ol>
<h2 id="policy"><a class="header" href="#policy">Policy</a></h2>
<p>Overall, I am a <em>very</em> understanding and flexible person, but please don’t force my hand.</p>
<h3 id="ask-questions"><a class="header" href="#ask-questions">Ask Questions</a></h3>
<blockquote>
<p>The man who asks a question is a fool for a minute, the man who does not ask is a fool for life. (Confucius)</p>
</blockquote>
<p>At times, my mind moves too fast for my own good, and I may skip steps.
<strong>If you are confused at any moment for any reason, please stop me.</strong>
I can guarantee you are not the only person in the room feeling that way.
I do understand it may be difficult to come forward with questions in a class environment, so I’ll also be providing a real-time anonymous question board you can take advantage of.
Finally, if you’re so confused that you cannot compose a meaningful question, <strong>please reach out</strong>, and we’ll work together to identify the root of the problem.</p>
<h3 id="attendance"><a class="header" href="#attendance">Attendance</a></h3>
<p>Attendance is mandatory.
We’ll be starting at 09:00 sharp as starting later is unfair to the students who made an effort to get to class on time.
If you are running late, please inform me at least 15 minutes before the start of class so that I can take note.
In the event of an absence, please inform both me and Dr. Thevenot.</p>
<h3 id="course-work"><a class="header" href="#course-work">Course Work</a></h3>
<p>I expect all relevant work from the day to be submitted (even if incomplete).
Work will not be explicitly graded, however, I plan to return a commented diff by the start of the next class.
At the start of each class, we might spend some time reviewing any common errors made in assignments.</p>
<h3 id="academic-integrity"><a class="header" href="#academic-integrity">Academic Integrity</a></h3>
<p><strong>I do not tolerate cheating of any kind.</strong>
If I have reasonable suspicion that you have cheated, I will report you to Cooper Union’s administration for a formal review.</p>
<p>It is painfully obvious when I read code that includes code not written by you.
That is not to say you cannot use online resources or LLMs, but I do expect proper attribution.
<strong>If you’re using just a snippet of code, type it out, and if possible, refactor it to fit the flow of your code.</strong>
I intend for such a practice to get you in the habit of understanding the code you read so that you can grow as a programmer.
That said, using larger snippets becomes problematic due to licensing, which could land you in legal trouble!</p>
<p><strong>tldr:</strong> write everything yourself!</p>
<h2 id="course-structure"><a class="header" href="#course-structure">Course Structure</a></h2>
<p>This course is segmented into three, two-week units.
With the exception of the last unit, we’ll try to stick to the following daily schedule:</p>
<ul>
<li>09:00–10:00 - Lecture for background/motivation</li>
<li>10:00–12:00 - Interactive lesson</li>
<li>12:00–13:00 - Lunch</li>
<li>13:00–15:00 - In-class assignment(s)</li>
</ul>
<p>At the end of each week, we will spend less time on learning and instead focus more on a single-day project.
The goal of this project is to encompass everything we covered during the week but also to prepare you for your open-ended final project.</p>
<h3 id="background"><a class="header" href="#background">Background</a></h3>
<p>In this unit, we’ll do a run-through of how to interact with Arduinos.
The first week will primarily focus on the basics of Arduino and useful parts of the C programming language when working in an embedded setting.
In the second week, we’ll set up a debugger to effectively navigate timers, interrupts, and communication peripherals.</p>
<h3 id="c-ing-beyond-arduino"><a class="header" href="#c-ing-beyond-arduino">C-ing Beyond Arduino</a></h3>
<p>In this unit, we’ll leave the Arduino framework behind and will start programming the ATmega328P on the Arduino Uno Rev3 directly.
In the first week, we’ll familiarize ourselves with interacting with the ATmega328P without a GUI or libraries; doing so entails becoming comfortable with the terminal, along with reading datasheets and sample code.
In the second week, we’ll explore the peripheral systems of the ATmega328P and learn how to work around its limitations.</p>
<h3 id="final-project"><a class="header" href="#final-project">Final Project</a></h3>
<p>In this final unit, we’ll work on an open-ended two-week final project in small groups.
This project will revolve around using the ATmega328P in a “real world” application where you’ll have the chance to work with sensors and hardware not covered in class; however, do keep in mind that some parts have long lead times.
We’ll also have drop-in lessons as necessary to ensure we finish in time for the final showcase.</p>
<h2 id="student-resources"><a class="header" href="#student-resources">Student Resources</a></h2>
<p><strong>Accommodations:</strong> <a href="https://cooper.edu/students/student-affairs/disability">https://cooper.edu/students/student-affairs/disability</a></p>
<p><strong>Mental Health Services:</strong> <a href="https://cooper.edu/students/student-affairs/health/counseling">https://cooper.edu/students/student-affairs/health/counseling</a></p>
<p><strong>Title IX:</strong> <a href="https://cooper.edu/students/student-affairs/sexual-misconduct">https://cooper.edu/students/student-affairs/sexual-misconduct</a></p>
<hr>
<ol class="footnote-definition"><li id="footnote-snap">
<p>I actually got started programming Arduinos with only a background in <a href="https://snap.berkeley.edu">Snap!</a> <a href="#fr-snap-1">↩</a></p>
</li>
</ol><div style="break-before: page; page-break-before: always;"></div><h1 id="background-1"><a class="header" href="#background-1">Background</a></h1>
<p>Tentative schedule:</p>
<ul>
<li><strong>2025-07-08:</strong> <a href="background/hello-world.html">Hello, World!</a></li>
<li><strong>2025-07-09:</strong> <a href="background/analog-&amp;-serial.html">Analog &amp; Serial</a></li>
<li><strong>2025-07-10:</strong> <a href="background/debugging.html">Debugging</a></li>
<li><strong>2025-07-14:</strong> <a href="background/bit-manipulation-&amp;-lookup-tables.html">Bit Manipulation &amp; Lookup Tables</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world"><a class="header" href="#hello-world">Hello, World!</a></h1>
<p><em>Getting the ball rolling with Arduino.</em></p>
<h2 id="outline"><a class="header" href="#outline">Outline</a></h2>
<ul>
<li>The basics of Information Theory, in particular, defining entropy</li>
<li>Working with different numeral systems:
<ul>
<li>Decimal, Binary, Octal, &amp; Hexadecimal</li>
<li>Two’s complement</li>
<li>Quick conversion between Binary, Octal, &amp; Hexadecimal</li>
</ul>
</li>
<li>Circuit fundamentals:
<ul>
<li>Ohm’s Law</li>
<li>Series vs Parallel</li>
<li>Power</li>
<li>Analog vs Digital</li>
</ul>
</li>
<li>Arduino basics:
<ul>
<li>Using the <a href="https://docs.arduino.cc/language-reference/">language reference</a></li>
<li><a href="https://docs.arduino.cc/language-reference/en/structure/sketch/setup/"><code>setup()</code></a> &amp; <a href="https://docs.arduino.cc/language-reference/en/structure/sketch/loop/"><code>loop()</code></a></li>
<li>Interfacing with digital IO</li>
<li>Delaying actions</li>
<li>Defining variables and constants</li>
<li>Arithmetic operations and assignment</li>
<li><a href="https://docs.arduino.cc/language-reference/en/structure/control-structure/if/"><code>if</code></a>-<a href="https://docs.arduino.cc/language-reference/en/structure/control-structure/else/"><code>else</code></a> statements</li>
</ul>
</li>
<li>Debouncing buttons</li>
<li>Crude debugging with an LED</li>
</ul>
<h2 id="exercises"><a class="header" href="#exercises">Exercises</a></h2>
<ol>
<li>
<p>In an attempt to absorb as much information as possible during the lesson, you suffer an exceptionally unexpected event and magically become stranded on an island with nothing but a laptop and your trusty Arduino.
To make matters worse, it’s night, and a new moon is out.</p>
<ol>
<li>
<p>Right as you’re about to start cursing your luck, you remember that the Arduino Uno Rev3 has a built-in LED, and there are some fishers about a mile out from the island.
Using your newfound knowledge, write a program to blink SOS so that you can make it back in time for tomorrow’s lesson!</p>
</li>
<li>
<p>Fortunately for you, the fishers noticed your SOS, shot a flare, and are now heading your way.
Unfortunately, you notice unsettling noises coming from the bushes not too far from you.
Thinking quickly, you decide to change the LED blinking pattern to be irritating and scare away anything from coming out to the beach.
Write a program that blinks the built-in LED in a range between 50 and 500 milliseconds.
Change the delay by 50 milliseconds every cycle, alternating between increasing and decreasing the delay depending on whether the delay time is saturated.</p>
</li>
<li>
<p>Having been rescued by the fishers, as a token of appreciation (and as a practical joke), you decide to make them a counter that keeps track of the number of fish that got away in a day.
They only have four LEDs, some resistors, and two push buttons on board.
Being resourceful, you build them a 4-bit, unsigned counter.
Write a program that displays in binary the number of fish that got away.
One button should increment the counter while the other should reset it back to zero.
If the counter overflows, turn on the built-in LED and turn off the remaining LEDs.</p>
</li>
</ol>
</li>
<li>
<p>Being soon-to-be broke college students, you’ll need to be resourceful with what you have on hand.
To prepare you for this reality, let’s create a dimmable Arduino night light using the built-in LED and a push button.
We can achieve this by varying the percentage of time we power the LED.
However, we need to perform this switching at a high enough frequency (&gt;1 kHz) so that we cannot perceive the flickering.
Utilize a push button to create 10 different LED brightness levels along with an off state.
The push button should cycle between increasing the brightness and turning off the LED.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="analog--serial"><a class="header" href="#analog--serial">Analog &amp; Serial</a></h1>
<p><em>More interesting interactions with the world.</em></p>
<h2 id="outline-1"><a class="header" href="#outline-1">Outline</a></h2>
<ul>
<li>Quantization</li>
<li>Pulse-Width Modulation (PWM)</li>
<li>Potentiometers</li>
<li>Analog to Digital Conversion (ADC)</li>
<li><a href="https://docs.arduino.cc/language-reference/en/functions/math/map/"><code>map()</code></a> function</li>
<li>Hysteresis</li>
<li><a href="https://docs.arduino.cc/language-reference/en/functions/communication/serial/"><code>Serial</code></a> communication:
<ul>
<li>RX vs TX</li>
<li>Baud rate</li>
<li>Parity</li>
<li>Serialization</li>
<li>Serial console</li>
</ul>
</li>
<li>ASCII encoding</li>
<li>RGB(A) color model</li>
<li>RGB LEDs</li>
<li><a href="https://docs.arduino.cc/language-reference/en/functions/communication/serial/"><code>Serial</code></a> debugging</li>
</ul>
<h2 id="exercises-1"><a class="header" href="#exercises-1">Exercises</a></h2>
<ol>
<li>
<p>In anticipation of building your own audio amplifier, you decide to create a volume indicator.
Using four LEDs, create a 4-LED volume indicator where a potentiometer serves as the volume knob.
Ensure that hysteresis is added to each of the volume regions to prevent flickering of volume levels.</p>
</li>
<li>
<p>Since I’m a huge Pink Floyd fan, let’s pick <a href="https://open.spotify.com/track/6FBPOJLxUZEair6x4kLDhf">Any Colour You Like</a>.
Utilize three potentiometers to change the color of an RGB LED to any color you like.
<strong>Optionally</strong>, add a button to dim the LED brightness by 50%.</p>
</li>
<li>
<p>Since moving our hands from the keyboard is such a hassle, let’s instead utilize the serial console to control the color of the LED.
Your code should expect a valid hex RGB value followed by a newline.
If this value is malformed, return an error to the user with a meaningful error code; otherwise, return a success code.
<strong>Optionally</strong>, add support for an optional alpha channel.
If the user supplies no alpha channel, assume alpha is 100%.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging"><a class="header" href="#debugging">Debugging</a></h1>
<p><em>Squash one bug and two more may appear.</em></p>
<h2 id="outline-2"><a class="header" href="#outline-2">Outline</a></h2>
<ul>
<li>Recursion</li>
<li>debugWire</li>
<li>Breakpoints</li>
<li>Watchpoints</li>
<li>Mutating memory</li>
<li>Evaluating expressions</li>
</ul>
<h2 id="exercises-2"><a class="header" href="#exercises-2">Exercises</a></h2>
<ol>
<li>
<p>Implement Fizz Buzz up to a number specified over the serial console.</p>
</li>
<li>
<p>Create a recursive factorial function.
This function should be able to at least successfully calculate 10 factorial.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bit-manipulation--lookup-tables"><a class="header" href="#bit-manipulation--lookup-tables">Bit Manipulation &amp; Lookup Tables</a></h1>
<p><em>Squeezing and pre-computing data.</em></p>
<h2 id="outline-3"><a class="header" href="#outline-3">Outline</a></h2>
<ul>
<li>Standard integer types</li>
<li>Endianness</li>
<li>Bitwise operations:
<ul>
<li>AND</li>
<li>OR</li>
<li>XOR</li>
<li>NOT</li>
<li>Left shift</li>
<li>Right shift</li>
</ul>
</li>
<li>Bit masks</li>
<li>Bit packing</li>
<li><code>enum</code>erations</li>
<li>Lookup tables</li>
<li><a href="https://docs.arduino.cc/language-reference/en/variables/utilities/sizeof/"><code>sizeof</code></a> operator</li>
<li><a href="https://docs.arduino.cc/language-reference/en/variables/variable-scope-qualifiers/static/"><code>static</code></a> storage class qualifier</li>
<li>Seven-segment displays</li>
</ul>
<h2 id="exercises-3"><a class="header" href="#exercises-3">Exercises</a></h2>
<ol>
<li>
<p>You’re working on an embedded system where a service technician needs to know status information at a glance.
To fulfill this requirement, you and your team decide that it’d be easiest to display a status code using a hex code.
Luckily, there’s only 16 different status states your system can assume, so a single seven segment display appears to be the perfect choice, however there’s only one problem: the hardware team still doesn’t know which pins on the microcontroller are going to be easiest to route to your seven segment display on the multi-layer PCB.
Being the brilliant engineer you are, you decide to create a lookup table that allows you to easily map segments to pins.
With this lookup table in mind, write code that displays any value between 0 and 15 on a seven-segment display.
Make sure to create a bit-packed lookup table for each of the hex digits.
To ensure your code works, continuously cycle through 0 and 15.</p>
</li>
<li>
<p>You’re working on a communication protocol, and following some clever math over <a href="https://en.wikipedia.org/wiki/GF(2)">GF(2)</a>, you end up with a <code>uint64_t</code> where each bit represents an irrecoverable bit error.
Since you’re working on a real-time system, you need to quickly determine if the number of bit errors is still recoverable.
Write code that counts the number of bits set in a <code>uint64_t</code>.
Make your code interactive by allowing a user to specify any integer over serial and reporting the number of bits set back to the user.</p>
</li>
<li>
<p>Since you’re working in an embedded environment, memory is a scarce resource, making logging a headache.
During the engineering design process, you and your team decide that you need to keep track of the occurrence of an event over the last eight time steps.
Write code that cyclically fills a <code>uint8_t</code> where we represent the presence of an event by a set bit.
When you press one push button, read the value of another to determine the occurrence of the event.
<strong>Optionally</strong>, add another button that will print the last eight events over serial when pressed.
During setup, zero the buffer to assume no events have happened.</p>
</li>
<li>
<p><strong>(Challenge)</strong> When dealing with a vast amount of binary data, corruption is inevitable.
Due to this possibility, we need a method to determine if our data has changed so that we can act accordingly.
One method is to utilize a 32-bit <a href="https://en.wikipedia.org/wiki/Cyclic_redundancy_check">Cyclic Redundancy Check</a> (CRC-32).
Implement a function that computes a CRC-32 given an array of <code>uint8_t</code>’s and the number of bytes using the standard IEEE polynomial of <code>0x04C11DB7</code> and initial condition of <code>0xFFFFFFFF</code>.
<strong>Remember</strong>, endianness matters here!
You might need to use the reversed version of the polynomial.
Create an array with the message “cooper union” and check if your function reports a correct CRC-32.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="examples"><a class="header" href="#examples">Examples</a></h1>
<ul>
<li><a href="examples/ascii-remap.html">ASCII Remap</a></li>
<li><a href="examples/button-debounce.html">Button Debounce</a></li>
<li><a href="examples/circular-buffer.html">Circular Buffer</a></li>
<li><a href="examples/lookup-tables.html">Lookup Tables</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ascii-remap"><a class="header" href="#ascii-remap">ASCII Remap</a></h1>
<pre><code class="language-cpp">static const uint32_t BAUD = 115200;

static const uint8_t DIGITS = 10;
static const uint8_t INVALID_INDEX = 255;

static uint8_t ascii_to_index(const unsigned char c)
{
  if ((c &gt;= '0') &amp;&amp; (c &lt;= '9'))
    return c - '0';

  if ((c &gt;= 'A') &amp;&amp; (c &lt;= 'Z'))
    return c - 'A' + DIGITS;

  if ((c &gt;= 'a') &amp;&amp; (c &lt;= 'z'))
    return c - 'a' + DIGITS;

  return INVALID_INDEX;
}

void setup(void)
{
  Serial.begin(BAUD);

  Serial.println(ascii_to_index('4'));
  Serial.println(ascii_to_index('J'));
  Serial.println(ascii_to_index('K'));
  Serial.println(ascii_to_index('!'));
}

void loop(void)
{
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="button-debounce"><a class="header" href="#button-debounce">Button Debounce</a></h1>
<pre><code class="language-cpp">static const uint8_t BUTTON = 2;

static const uint8_t DEBOUNCE_MS = 4;

static bool button_state;

void setup(void)
{
  pinMode(BUTTON, INPUT);

  pinMode(LED_BUILTIN, OUTPUT);

  digitalWrite(LED_BUILTIN, button_state);
}

void loop(void)
{
  // get our initial sample of the button
  bool button_sample = digitalRead(BUTTON);

  // wait for the button to settle
  delay(DEBOUNCE_MS);

  // if the current sample is the same as the
  // previous we assume the new button state
  if (digitalRead(BUTTON) == button_sample)
    button_state = button_sample;

  digitalWrite(LED_BUILTIN, button_state);
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="circular-buffer"><a class="header" href="#circular-buffer">Circular Buffer</a></h1>
<pre><code class="language-cpp">static const char MESSAGE[] = "cooper union ";

static const uint8_t WINDOW_SIZE = 4;

// exclude the NULL character when calculating the size
static const uint8_t MESSAGES_SIZE = sizeof(MESSAGE) - 1;

static const uint32_t BAUD  = 115200;
static const uint16_t DELAY = 500;

void setup(void)
{
  Serial.begin(BAUD);
}

void loop(void)
{
  static uint8_t index;

  for (size_t i = 0; i &lt; WINDOW_SIZE; i++)
    Serial.print(MESSAGE[(index + i) % MESSAGES_SIZE]);

  Serial.print('\n');

  index = (index + 1) % MESSAGES_SIZE;

  delay(DELAY);
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lookup-tables"><a class="header" href="#lookup-tables">Lookup Tables</a></h1>
<pre><code class="language-cpp">enum {
  RED,
  GREEN,
  BLUE,
  COLORS_TOTAL,
};

static const uint16_t ADC_MAX = (1 &lt;&lt; 10) - 1;
static const uint8_t  PWM_MAX = (1 &lt;&lt; 8)  - 1;

static const uint8_t COLOR_TO_PIN[COLORS_TOTAL] = {
  [RED]   = 9,
  [GREEN] = 10,
  [BLUE]  = 11,
};

static const uint8_t POTENTIOMETER_TO_PIN[COLORS_TOTAL] = {
  [RED]   = A0,
  [GREEN] = A1,
  [BLUE]  = A2,
};

void setup(void)
{
  for (size_t i = 0; i &lt; COLORS_TOTAL; i++) {
    pinMode(POTENTIOMETER_TO_PIN[i], INPUT);

    pinMode(COLOR_TO_PIN[i], OUTPUT);
    digitalWrite(COLOR_TO_PIN[i], LOW);
  };
}

void loop(void)
{
  for (size_t i = 0; i &lt; COLORS_TOTAL; i++) {
    const uint16_t sample = analogRead(POTENTIOMETER_TO_PIN[i]);
    analogWrite(COLOR_TO_PIN[i], map(sample, 0, ADC_MAX, 0, PWM_MAX));
  }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-tos"><a class="header" href="#how-tos">How-tos</a></h1>
<ul>
<li><a href="how-tos/debugwire.html">debugWire</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugwire"><a class="header" href="#debugwire">debugWire</a></h1>
<p>You’ll need two Arduino Uno Rev3s.
One will serve as our target, which will get debugged, while the other will act as the actual debugger.
To make this possible, we’ll be taking advantage of <a href="https://github.com/felias-fogg/dw-link"><code>dw-link</code></a> to turn one of the Arduinos into a debugger.</p>
<ol>
<li>Grab the <a href="https://github.com/felias-fogg/dw-link/releases">latest release</a> of <a href="https://github.com/felias-fogg/dw-link"><code>dw-link</code></a>.
<ol>
<li><strong>(Optionally)</strong> Feel free to read the <a href="https://github.com/felias-fogg/dw-link/blob/master/docs/manual.md"><code>dw-link</code> manual</a>.</li>
</ol>
</li>
<li>Compile and upload the sketch to your designated Arduino debugger.</li>
<li><a href="https://github.com/MCUdude/MiniCore#how-to-install">Install</a> <a href="https://github.com/MCUdude/MiniCore">MiniCore</a> using the board manager.</li>
<li>Set your board to be the MiniCore ATmega328, disable compiler LTO, and optimize sketches for debugging.</li>
<li>We have already enabled debugWire on all of the target boards, so it is sufficient to connect pin 8 of the debugger board to the reset pin of the target, along with power and ground to their respective locations.</li>
<li>Verify your sketch at least once before starting debugging.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-6752007c.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-66cfebdd.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
